<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>JAVA学习笔记-spring | Muite</title><meta name="author" content="Muite"><meta name="copyright" content="Muite"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="简介spring是一个IoC和AOP框架 Spring的特性：  非侵入式：基于Spring开发的应用中的对象可以不依赖于Spring的API 依赖注入：DI（Dependency Injection）是反转控制（IoC：Inversion of Control）最经典的实现 面向切面编程：Aspect Oriented Programming  (AOP) 容器：Spring提供一个容器，包含并">
<meta property="og:type" content="article">
<meta property="og:title" content="JAVA学习笔记-spring">
<meta property="og:url" content="https://mutesniper.github.io/2025/03/17/spring/index.html">
<meta property="og:site_name" content="Muite">
<meta property="og:description" content="简介spring是一个IoC和AOP框架 Spring的特性：  非侵入式：基于Spring开发的应用中的对象可以不依赖于Spring的API 依赖注入：DI（Dependency Injection）是反转控制（IoC：Inversion of Control）最经典的实现 面向切面编程：Aspect Oriented Programming  (AOP) 容器：Spring提供一个容器，包含并">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img.alicdn.com/bao/uploaded/i3/2200690044395/O1CN012NL22Q1iKxHYWb17f_!!2200690044395.jpg">
<meta property="article:published_time" content="2025-03-17T04:46:00.000Z">
<meta property="article:modified_time" content="2025-04-03T11:33:40.360Z">
<meta property="article:author" content="Muite">
<meta property="article:tag" content="JAVA">
<meta property="article:tag" content="note">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.alicdn.com/bao/uploaded/i3/2200690044395/O1CN012NL22Q1iKxHYWb17f_!!2200690044395.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "JAVA学习笔记-spring",
  "url": "https://mutesniper.github.io/2025/03/17/spring/",
  "image": "https://img.alicdn.com/bao/uploaded/i3/2200690044395/O1CN012NL22Q1iKxHYWb17f_!!2200690044395.jpg",
  "datePublished": "2025-03-17T04:46:00.000Z",
  "dateModified": "2025-04-03T11:33:40.360Z",
  "author": [
    {
      "@type": "Person",
      "name": "Muite",
      "url": "https://mutesniper.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://mutesniper.github.io/2025/03/17/spring/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JAVA学习笔记-spring',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/1990ee2c41564e328f35ac72f555f170.jpeg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://img.alicdn.com/bao/uploaded/i3/2200690044395/O1CN012NL22Q1iKxHYWb17f_!!2200690044395.jpg" onerror="this.onerror=null;this.src='/null'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"></a><a class="nav-page-title" href="/"><span class="site-name">JAVA学习笔记-spring</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">JAVA学习笔记-spring</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-17T04:46:00.000Z" title="Created 2025-03-17 12:46:00">2025-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-03T11:33:40.360Z" title="Updated 2025-04-03 19:33:40">2025-04-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/java-note/">java-note</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>spring是一个IoC和AOP框架</p>
<p>Spring的特性：</p>
<ul>
<li>非侵入式：基于Spring开发的应用中的对象可以不依赖于Spring的API</li>
<li>依赖注入：DI（Dependency Injection）是反转控制（IoC：Inversion of Control）最经典的实现</li>
<li>面向切面编程：Aspect Oriented Programming  (AOP)</li>
<li>容器：Spring提供一个容器，包含并管理应用对象的生命周期</li>
<li>组件化：Spring将众多简单的组件配置组合成一个复杂应用</li>
</ul>
<p>Spring的核心就是提供了一个IoC容器，它可以管理所有轻量级的JavaBean组件，提供的底层服务包括组件的生命周期管理、配置和组装服务、AOP支持，以及建立在AOP基础上的声明式事务服务等。</p>
<h1 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h1><h2 id="组件和容器"><a href="#组件和容器" class="headerlink" title="组件和容器"></a>组件和容器</h2><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p>具有一定功能的对象，比如servlet组件、DAO组件、service业务组件</p>
<h3 id="容器-1"><a href="#容器-1" class="headerlink" title="容器"></a>容器</h3><p>管理组件(创建、获取、保存、销毁)</p>
<p>比如tomcat是servlet容器</p>
<h2 id="IoC和DI"><a href="#IoC和DI" class="headerlink" title="IoC和DI"></a>IoC和DI</h2><h3 id="IoC"><a href="#IoC" class="headerlink" title="IoC"></a>IoC</h3><ul>
<li>控制：资源的控制权（资源的创建，获取，销毁等）</li>
<li>反转：对于资源的操作交给容器来做，而不是我们</li>
</ul>
<h3 id="DI"><a href="#DI" class="headerlink" title="DI"></a>DI</h3><ul>
<li>依赖：组件的依赖关系，比如NewsController依赖NewsServices（不是指jar包）</li>
<li>注入：通过setter方法、构造器等方式自动的注入（赋值）</li>
</ul>
<p>具体来说，Spring IoC 容器管理的是应用程序中的 <strong>Bean</strong>，这些 Bean 实际上是通过类创建的对象实例。容器负责这些对象的生命周期管理、配置属性设置以及依赖注入等。</p>
<h3 id="Spring-IoC-容器管理的内容"><a href="#Spring-IoC-容器管理的内容" class="headerlink" title="Spring IoC 容器管理的内容"></a>Spring IoC 容器管理的内容</h3><ol>
<li><strong>Bean 实例</strong>：IoC 容器中存储的是由开发者定义的类所创建的对象（即Bean）。这些对象可以是服务层对象、数据访问对象（DAO）、控制器等任何类型的组件。</li>
<li><strong>依赖关系</strong>：当一个 Bean 需要另一个 Bean 来完成其功能时，IoC 容器会自动将所需的依赖注入到该 Bean 中。这种依赖通常是其他对象实例。</li>
<li><strong>配置元数据</strong>：这包括如何创建 Bean 的信息，如构造函数参数、属性值等。配置可以通过 XML 文件、注解或者 Java 配置类来提供。</li>
<li><strong>生命周期回调</strong>：某些 Bean 可能需要在初始化后或销毁前执行特定的操作，IoC 容器支持注册相应的初始化和销毁方法。</li>
</ol>
<h2 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h2><h3 id="把组件放进容器中"><a href="#把组件放进容器中" class="headerlink" title="把组件放进容器中"></a>把组件放进容器中</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.作用：跑起一个SPRING应用</span></span><br><span class="line"><span class="comment">//ApplicationContext：Spring应用上下文对象；ioc容器</span></span><br><span class="line"><span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span> SpringApplication.run(Spring01IocApplication.class, args);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.给容器中注册一个自己的组件</span></span><br><span class="line"><span class="comment">//容器中的每一个组件都有自己的名字，方法名就是组件的名字，但是可以通过@Bean后的括号配置</span></span><br><span class="line"><span class="meta">@Bean(&quot;zhangsan&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">zhangsan</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    person.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="获取组件"><a href="#获取组件" class="headerlink" title="获取组件"></a>获取组件</h3><p>添加了以下组件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(&quot;zhangsan&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">zhangsan</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    person.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Bean(&quot;lisi&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">lisi</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    person.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Dog <span class="title function_">dog</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>获取的不同情况：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">        <span class="comment">//4.获取容器中的组件对象</span></span><br><span class="line">        <span class="comment">//组件的四大特性：名字、类型、作用域、对象</span></span><br><span class="line">        <span class="comment">//可以通过名字、类型获得组件对象</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//小结</span></span><br><span class="line">        <span class="comment">//从容器中获取组件</span></span><br><span class="line">        <span class="comment">//1）、如果获取组件而组件不存在,抛异常NoSuchBeanDefinitionException</span></span><br><span class="line">        <span class="comment">//2）、组件不唯一，</span></span><br><span class="line">        <span class="comment">//      用单个对象接收 NoUniqueBeanDefinitionException</span></span><br><span class="line">        <span class="comment">//      用集合接收，可以</span></span><br><span class="line">        <span class="comment">//3）、组件唯一，正确返回</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.1.按照组件的名字获取对象</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">zhangsan</span> <span class="operator">=</span> (Person) ioc.getBean(<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;对象=&quot;</span>+zhangsan);</span><br><span class="line"></span><br><span class="line">        <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> (Dog) ioc.getBean(<span class="string">&quot;dog&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;dog=&quot;</span>+dog);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.2.按照组件类型获取对象</span></span><br><span class="line"><span class="comment">//      Person bean=ioc.getBean(Person.class);</span></span><br><span class="line"><span class="comment">//      System.out.println(&quot;bean=&quot;+bean);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.3.按照组件类型获取这种类型的所有对象</span></span><br><span class="line">        Map&lt;String, Person&gt; map = ioc.getBeansOfType(Person.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;map=&quot;</span>+map);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//4.4按照类型加名字</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">zhangsan1</span> <span class="operator">=</span> ioc.getBean(<span class="string">&quot;zhangsan&quot;</span>, Person.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;zhangsan1=&quot;</span>+zhangsan1);</span><br></pre></td></tr></table></figure>



<h3 id="组件的创建时机"><a href="#组件的创建时机" class="headerlink" title="组件的创建时机:"></a>组件的创建时机:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Dog</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;dog构造器&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span> SpringApplication.run(Spring01IocApplication.class, args);</span><br><span class="line">    System.out.println(<span class="string">&quot;=====ioc容器创建完成====&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.获取组件</span></span><br><span class="line">    <span class="type">Dog</span> <span class="variable">bean</span> <span class="operator">=</span> ioc.getBean(Dog.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;bean=&quot;</span>+bean);</span><br><span class="line">    </span><br><span class="line">    <span class="type">Dog</span> <span class="variable">bean1</span> <span class="operator">=</span> ioc.getBean(Dog.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;bean=&quot;</span>+bean1);</span><br><span class="line"></span><br><span class="line">    <span class="type">Dog</span> <span class="variable">bean2</span> <span class="operator">=</span> ioc.getBean(Dog.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;bean=&quot;</span>+bean2);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dog构造器</span><br><span class="line"><span class="number">2025</span>-<span class="number">03</span>-05T18:<span class="number">54</span>:<span class="number">42.679</span>+08:<span class="number">00</span>  INFO <span class="number">3788</span> --- [spring-<span class="number">01</span>-ioc] [           main] c.a.spring.ioc.Spring01IocApplication    : Started Spring01IocApplication in <span class="number">0.577</span> seconds (process running <span class="keyword">for</span> <span class="number">0.902</span>)</span><br><span class="line">=====ioc容器创建完成====</span><br><span class="line">bean=Dog()</span><br><span class="line">bean=Dog()</span><br><span class="line">bean=Dog()</span><br></pre></td></tr></table></figure>

<p>可以发现，在ioc容器启动过程中就创建了组件对象</p>
<p>并且只创建了一次对象，这说明对象是单例的,每次获取直接从容器中拿。容器会提前创建组件</p>
<h3 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h3><p>可以发现我们之前的添加组件的方式会使主程序类中的代码显得十分繁琐，这就可以用到配置类</p>
<p>我们可以给Bean（存放Person、Dog等类的包）创建一个同级目录config，并创建DogConfig、PersonConfig类（配置类），将以上添加组件的方法分类写进配置类。并添加<code>@Configuration</code>,这样也可以达到自定义组件的效果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">@Configuration //告诉Spring容器，这是一个配置类</span><br><span class="line">public class PersonConfig &#123;</span><br><span class="line">    //3.给容器中注册一个自己的组件</span><br><span class="line">    //容器中的每一个组件都有自己的名字，方法名就是组件的名字</span><br><span class="line">    @Bean(&quot;zhangsan&quot;)</span><br><span class="line">    public Person zhangsan()&#123;</span><br><span class="line">        Person person = new Person();</span><br><span class="line">        person.setName(&quot;张三&quot;);</span><br><span class="line">        person.setAge(18);</span><br><span class="line">        person.setGender(&quot;男&quot;);</span><br><span class="line">        return person;</span><br><span class="line">    &#125;</span><br><span class="line">    @Bean(&quot;lisi&quot;)</span><br><span class="line">    public Person lisi()&#123;</span><br><span class="line">        Person person = new Person();</span><br><span class="line">        person.setName(&quot;张三&quot;);</span><br><span class="line">        person.setAge(18);</span><br><span class="line">        person.setGender(&quot;男&quot;);</span><br><span class="line">        return person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em><strong>注意：</strong></em>配置类也是容器中的组件</p>
<h3 id="MVC分层注解"><a href="#MVC分层注解" class="headerlink" title="MVC分层注解"></a>MVC分层注解</h3><ul>
<li>@Controller    控制层</li>
<li>@Service          服务层</li>
<li>@Repository    持久层</li>
<li>@Component  组件</li>
</ul>
<p>分层注解只是方便人为识别，其实底层都是@Component普通组件</p>
<p><em><strong>注意：</strong></em>分层注解起作用的前提是，这些组件必须在主程序所在的包及其子包结构下</p>
<h3 id="批量扫描"><a href="#批量扫描" class="headerlink" title="批量扫描"></a>批量扫描</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(basePackages=&quot;com&quot;)</span></span><br></pre></td></tr></table></figure>

<p>组件批量扫描，将com包下用相关注解标记过的组件注册到容器中</p>
<p>但是规范编程一般就将主程序所在包当作包的根，其他包或java类都在此包下进行</p>
<h3 id="导入第三方组件"><a href="#导入第三方组件" class="headerlink" title="导入第三方组件"></a>导入第三方组件</h3><p>第三方库想要导入容器中，无法快速标注分层注解</p>
<p>方法：</p>
<ol>
<li>@Bean自己new，注册给容器（记得先import对应的库）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">比如CoreConstants</span><br><span class="line"><span class="keyword">import</span> ch.qos.logback.core.CoreConstants;</span><br><span class="line">....</span><br><span class="line"><span class="keyword">public</span> CoreConstants <span class="title function_">coreConstants</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CoreConstants</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>使用注解@Import(CoreConstants.class)</li>
</ol>
<p>为了防止主程序上的注解太多导致乱，我们在config包下定义一个AppConfig配置类，将用法类似的注解(如ComponentScan)标在其上（不会影响注解的功能，因为在添加此配置类为组件之前，会扫描注解，将注解中标示要添加为组件的组件也加入容器）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(CoreConstants.class)</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(basePackages=&quot;com&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果多个，放在大括号里，用逗号隔开</p>
<h3 id="调整组件作用域"><a href="#调整组件作用域" class="headerlink" title="调整组件作用域"></a>调整组件作用域</h3><ol>
<li><p>@Scope(“prototype”)     非单实例</p>
<p> 容器启动的期间不会创建非单实例组件的对象，什么时候获取什么时候创建</p>
</li>
<li><p>@Scope(“singleton”)       单实例</p>
<p> 容器启动的期间会创建非单实例组件的对象,容器启动完成前就创建了</p>
</li>
<li><p>@Scope(“request”)          同一个请求单实例</p>
</li>
<li><p>@Scope(“session”)           同一次绘画单实例</p>
</li>
</ol>
<p>不写Scope注解的情况下，相当于singleton</p>
<p>3、4用到很少</p>
<h3 id="单例情况下的懒加载"><a href="#单例情况下的懒加载" class="headerlink" title="单例情况下的懒加载"></a>单例情况下的懒加载</h3><p>即让单例组件也变成：</p>
<p> 容器启动的期间不会创建非单实例组件的对象，什么时候获取什么时候创建</p>
<h3 id="利用工厂制造复杂Bean"><a href="#利用工厂制造复杂Bean" class="headerlink" title="利用工厂制造复杂Bean"></a>利用工厂制造复杂Bean</h3><p>应用场景：要制造的对象比较复杂，利用工厂方法进行创建</p>
<p>Bean:组件(实例)</p>
<p>在根目录（主程序所在包）下，创建一个factory包，编写一个类实现FactoryBean接口，并重写里面的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BYDFactory</span> <span class="keyword">implements</span> <span class="title class_">FactoryBean</span>&lt;Car&gt; &#123;</span><br><span class="line">    <span class="comment">//调用此方法给容器中制造对象</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Car <span class="title function_">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Car</span>();</span><br><span class="line">        <span class="keyword">return</span> car;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//说明造的东西的类型</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> Car.class;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//true：单例； false：非单例</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSingleton</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> FactoryBean.<span class="built_in">super</span>.isSingleton();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Spring01IocApplication.class, args);</span><br><span class="line">    <span class="type">Car</span> <span class="variable">car</span> <span class="operator">=</span> context.getBean(Car.class);</span><br><span class="line">    Map&lt;String,Car&gt; cars = context.getBeansOfType(Car.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;cars: &quot;</span> + cars);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过输出的结果<code>cars: &#123;BYDFactory=com.atguigu.spring.ioc.bean.Car@41aaedaa&#125;</code>可知，工厂创建的组件的名和工厂的名字一致，而类型则是FactoryBean&lt;&gt;中&lt;&gt;里面的泛型类型</p>
<h3 id="Conditional"><a href="#Conditional" class="headerlink" title="@Conditional"></a>@Conditional</h3><p><strong>此注解适用于方法和类</strong></p>
<h4 id="条件注册"><a href="#条件注册" class="headerlink" title="条件注册"></a>条件注册</h4><p>满足条件的情况下，才加入此组件</p>
<p>举例：当前环境是windows，加入bill组件，mac则加入joseph组件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Conditional(WindowsCondition.class)</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">joseph</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setName(<span class="string">&quot;乔布斯&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    person.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Conditional(MacCondition.class)</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">bill</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setName(<span class="string">&quot;比尔盖茨&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    person.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Conditional</span>的参数类型是Class&lt;? <span class="keyword">extends</span> <span class="title class_">Condition</span>&gt;[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WindowsCondition</span> <span class="keyword">implements</span> <span class="title class_">Condition</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span> &#123;</span><br><span class="line">        <span class="type">Environment</span> <span class="variable">environment</span> <span class="operator">=</span> context.getEnvironment();</span><br><span class="line">        <span class="type">String</span> <span class="variable">osName</span> <span class="operator">=</span> environment.getProperty(<span class="string">&quot;OS&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> osName.toLowerCase().contains(<span class="string">&quot;windows&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MacCondition</span> <span class="keyword">implements</span> <span class="title class_">Condition</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span> &#123;</span><br><span class="line">        <span class="type">Environment</span> <span class="variable">environment</span> <span class="operator">=</span> context.getEnvironment();</span><br><span class="line">        <span class="type">String</span> <span class="variable">osName</span> <span class="operator">=</span> environment.getProperty(<span class="string">&quot;OS&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> osName.toLowerCase().contains(<span class="string">&quot;mac&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ConfigurableApplicationContext</span> <span class="variable">context</span> <span class="operator">=</span> SpringApplication.run(Spring01IocApplication.class, args);</span><br><span class="line">        Map&lt;String,Person&gt; persons = context.getBeansOfType(Person.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;beans=&quot;</span> + persons);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终显示只有比尔盖茨组件</p>
<h4 id="Conditional派生注解"><a href="#Conditional派生注解" class="headerlink" title="@Conditional派生注解"></a>@Conditional派生注解</h4><ul>
<li>@ConditionOnMissingBean（）：没有括号内参数对应的组件时，添加</li>
<li>@ConditionOnBean（）：有括号内参数对应的组件时，添加</li>
<li>@ConditionOnResource（）：有资源，添加</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConditionOnMissingBean</span>（value=&#123;Person.class&#125;）</span><br><span class="line"><span class="meta">@ConditionOnMissingBean</span>（name=<span class="string">&quot;bill&quot;</span>）</span><br><span class="line">    </span><br><span class="line"><span class="meta">@ConditionOnBean</span>（name=<span class="string">&quot;bill&quot;</span>）</span><br><span class="line">    </span><br><span class="line"><span class="meta">@ConditionOnResource</span>（resources=<span class="string">&quot;classpath:haha.abc&quot;</span>)</span><br><span class="line"><span class="comment">//classpath表示未来打包进target/classes的包，main下的java和resources包都是</span></span><br></pre></td></tr></table></figure>



<h2 id="注入"><a href="#注入" class="headerlink" title="注入"></a>注入</h2><h3 id="Autowired自动装配"><a href="#Autowired自动装配" class="headerlink" title="@Autowired自动装配"></a>@Autowired自动装配</h3><p>原理：Spring调用  容器.getBean()   </p>
<p>流程：</p>
<ol>
<li><p>按照类型，找到这个组件；</p>
<p>​	1.0 如果仅有一个此类组件，直接注入</p>
<p>​	1.1 如果找到多个，再按名字去找；变量名就是名字</p>
<p>​			1.1.1 如果找到，注入</p>
<p>​			1.1.2 找不到，报错</p>
</li>
</ol>
<p>		</p>
<p>即先按照类型，再按照组件名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    Person bill;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//把所有这个类型的组件都拿来</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    List&lt;Person&gt; people;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    Map&lt;String, Person&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//拿到ioc容器</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span> SpringApplication.run(Spring01IocApplication.class, args);</span><br><span class="line">    System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">UserController</span> <span class="variable">userController</span> <span class="operator">=</span> ioc.getBean(UserController.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;UserController = &quot;</span> + userController);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取单个</span></span><br><span class="line">UserController = UserController(userService=com.atguigu.spring.ioc.service.UserService@5ee34b1b, bill=Person(name=比尔盖茨, age=<span class="number">18</span>, gender=男), </span><br><span class="line"></span><br><span class="line"><span class="comment">//获取全部同类对象                                </span></span><br><span class="line">people=[Person(name=张三, age=<span class="number">18</span>, gender=男), Person(name=<span class="literal">null</span>, age=<span class="number">0</span>, gender=<span class="literal">null</span>), Person(name=乔布斯, age=<span class="number">18</span>, gender=男), Person(name=比尔盖茨, age=<span class="number">18</span>, gender=男)],</span><br><span class="line"></span><br><span class="line">map=&#123;Zhangsan=Person(name=张三, age=<span class="number">18</span>, gender=男), lisi=Person(name=<span class="literal">null</span>, age=<span class="number">0</span>, gender=<span class="literal">null</span>), joseph=Person(name=乔布斯, age=<span class="number">18</span>, gender=男), bill=Person(name=比尔盖茨, age=<span class="number">18</span>, gender=男)&#125;, </span><br><span class="line"></span><br><span class="line"><span class="comment">//ioc容器</span></span><br><span class="line">                               applicationContext=org.springframework.context.annotation.AnnotationConfigApplicationContext@6dee4f1b, started on Thu Mar <span class="number">06</span> 08:<span class="number">10</span>:<span class="number">57</span> CST <span class="number">2025</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Qualifier和-Primary"><a href="#Qualifier和-Primary" class="headerlink" title="@Qualifier和@Primary"></a>@Qualifier和@Primary</h3><p>@Qualifier（组件名）：</p>
<p>精确指定，如果容器中这样的组件有多个，则使用@Qualifier精确指定组件名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123; </span><br><span class="line">    <span class="meta">@Qualifier(&quot;bill&quot;)</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    Person person;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>@Primary:</p>
<p>指定主要，按类型获取单个，如果有多个组件，获取主要的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="comment">//@Conditional(WindowsCondition.class)</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Person <span class="title function_">bill</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line">    person.setName(<span class="string">&quot;比尔盖茨&quot;</span>);</span><br><span class="line">    person.setAge(<span class="number">18</span>);</span><br><span class="line">    person.setGender(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> person;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Resource自动注入"><a href="#Resource自动注入" class="headerlink" title="@Resource自动注入"></a>@Resource自动注入</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"><span class="comment">/*    @Qualifier(&quot;bill&quot;)</span></span><br><span class="line"><span class="comment">    @Autowired</span></span><br><span class="line"><span class="comment">    Person person;*/</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    UserDao userDao;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Resource和@Autowired的区别？</p>
<ul>
<li>**<code>@Autowired</code>**：这是 Spring 框架提供的注解，属于 Spring 自己的依赖注入机制的一部分。</li>
<li>**<code>@Resource</code>**：这是 Java 标准提供的注解，因此它不仅可以在 Spring 中使用，也可以在其他支持该标准的框架中使用。</li>
</ul>
<p>@Resource具有更强的通用性</p>
<p>且@Autowired可以调为required&#x3D;false</p>
<p>所以以后直接用@Autowired就行</p>
<h3 id="构造器注入"><a href="#构造器注入" class="headerlink" title="构造器注入"></a>构造器注入</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    Dog dog;</span><br><span class="line">    <span class="comment">//因为UserDao标记为Repository,且UserDao类只有有参构造器</span></span><br><span class="line">    <span class="comment">//Spring在创建UserDao组件时调用有参构造器，就会传入一个Dog，实现注入</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserDao</span><span class="params">(Dog dog)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.dog = dog;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="setter方法注入"><a href="#setter方法注入" class="headerlink" title="setter方法注入"></a>setter方法注入</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDog</span><span class="params">(Dog dog)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.dog = dog;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这里的dog也可以指定</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDog</span><span class="params">(<span class="meta">@Qualifier(&quot;dog1&quot;)</span>Dog dog)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.dog = dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="xxxAware感知接口"><a href="#xxxAware感知接口" class="headerlink" title="xxxAware感知接口"></a>xxxAware感知接口</h3><p>在Spring框架中，“感知接口”是指一系列特殊的接口，通过实现这些接口，Bean可以表明它们需要容器提供某些信息或资源。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">hahaService</span> <span class="keyword">implements</span> <span class="title class_">EnvironmentAware</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Environment environment;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEnvironment</span><span class="params">(Environment environment)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.environment = environment;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getOsType</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> environment.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Spring发现实现了Environment接口，会自动将环境变量传入</p>
<h3 id="value-属性赋值"><a href="#value-属性赋值" class="headerlink" title="@value 属性赋值"></a>@value 属性赋值</h3><ul>
<li>@Value(“字面值”) :直接赋值</li>
<li>@Value（“${key}”）:动态从配置文件取出某一项的值</li>
<li>@Value（“${key:默认值}”）:动态从配置文件取出某一项的值,取不到则用默认值</li>
<li>@Value(“#{SpEL}”) :Spring Expression Language;spring表达式语言。在其中的代码可以执行,甚至可以写url</li>
</ul>
<p>比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;#&#123;T(java.util.UUID).randomUUID().toString()&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;#&#123;10*2&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;#&#123;&#x27;Hello World&#x27;.substring(0,5)&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String msg;</span><br></pre></td></tr></table></figure>



<h3 id="PropertySource"><a href="#PropertySource" class="headerlink" title="@ PropertySource"></a>@ PropertySource</h3><p>在使用value从配置文件中动态取出值时，如果要配置的属性很多，那么application.properties配置文件会显得冗长</p>
<p>所以在resources包下创建dog.properties等，将关于狗的配置写进</p>
<p>但是这样会发现报错，无法赋值</p>
<p>所以说明属性来源，把指定的文件<strong>导入</strong>容器中，供我们取值使用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(&quot;classpath:dog.properties&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Dog</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;dog构造器&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>补充:</strong></p>
<p>classpath:表示从自己项目的类路径下找</p>
<p>classpath*:  表示从所有包的类路径下找</p>
<h3 id="ResourceUtils获取资源"><a href="#ResourceUtils获取资源" class="headerlink" title="ResourceUtils获取资源"></a>ResourceUtils获取资源</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File file=ResourceUtils.getFile(<span class="string">&quot;classpath:abc.jpg&quot;</span>);</span><br><span class="line"><span class="type">int</span> available=<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file).available();</span><br><span class="line">sout(available);</span><br><span class="line"><span class="comment">//获取资源大小</span></span><br></pre></td></tr></table></figure>

<p>还可以用url等参数获取资源，更多参数类型见源码</p>
<h3 id="Profile-多环境"><a href="#Profile-多环境" class="headerlink" title="@Profile 多环境"></a>@Profile 多环境</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">dataSourceConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.定义环境标识</span></span><br><span class="line">    <span class="comment">//2.激活环境标识：</span></span><br><span class="line">       <span class="comment">//明确告诉spring当前环境</span></span><br><span class="line">       <span class="comment">//不说就是defalt环境</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//利用环境注解，只在某种环境下激活一个组件</span></span><br><span class="line">    <span class="meta">@Profile(&quot;dev&quot;)</span><span class="comment">// @profile（“环境标识”）</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MyDataSource <span class="title function_">dev</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MyDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyDataSource</span>();</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/dev&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;dev_user&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;dev_pass&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Profile(&quot;test&quot;)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MyDataSource <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MyDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyDataSource</span>();</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/test&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;test_user&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;test_pass&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Profile(&quot;prod&quot;)</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MyDataSource <span class="title function_">prod</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">MyDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyDataSource</span>();</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/dev&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;prod_user&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;prod_pass&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeliveryDao</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 问题一:数据源组件有三个</span></span><br><span class="line"><span class="comment">    * 告诉数据源，哪种数据源在哪种情况下生效。想到@Conditional</span></span><br><span class="line"><span class="comment">    * 但除此之外，还有@Profile</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">        MyDataSource dataSource;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">saveDelivery</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;数据源：&quot;</span>+dataSource);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如何告诉spring当前环境呢？</p>
<p>在配置文件中写<code>spring.profiles.active=</code>后面加环境</p>
<p><strong>此外</strong>，@Profile还可定义在类上,表示在指定环境下类才生效</p>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><h3 id="Bean指定初始化、销毁方法"><a href="#Bean指定初始化、销毁方法" class="headerlink" title="@Bean指定初始化、销毁方法"></a>@Bean指定初始化、销毁方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCar</span><span class="params">(Car car)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;自动注入&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.car = car;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;User 构造器&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initUser</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;@Bean 初始化：initUser&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyUser</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;@Bean 销毁：destroyUser&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserConfig</span> &#123;</span><br><span class="line">       <span class="comment">//添加组件并</span></span><br><span class="line">        <span class="meta">@Bean(initMethod = &quot;initUser&quot;,destroyMethod = &quot;destroyUser&quot;)</span></span><br><span class="line">        <span class="keyword">public</span> User <span class="title function_">user</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ConfigurableApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span> SpringApplication.run(Spring01IocApplication.class, args);</span><br><span class="line">    System.out.println(<span class="string">&quot;======ioc容器创建完成=========&quot;</span>);</span><br><span class="line">    User bean=ioc.getBean(User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;运行：&quot;</span>+bean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">User 构造器</span><br><span class="line">自动注入</span><br><span class="line"><span class="meta">@Bean</span> 初始化：initUser</span><br><span class="line">...</span><br><span class="line">======ioc容器创建完成=========</span><br><span class="line">运行：User(name=<span class="literal">null</span>, password=<span class="literal">null</span>, car=com.atguigu.spring.ioc.bean.Car<span class="meta">@af78c87</span>)</span><br><span class="line"><span class="meta">@Bean</span> 销毁：destroyUser</span><br></pre></td></tr></table></figure>

<p>可以发现，组件的创建、属性值自动注入、组件初始化都在ioc创建完成前进行</p>
<p><strong>组件的生命周期</strong></p>
<p>构造器创建–&gt;@Autowired属性注入–&gt;@Bean指定的init方法进行初始化–&gt;运行–&gt;@Bean指定的destory方法进行销毁–&gt;容器结束</p>
<h3 id="InitializingBean、DisposableBean接口"><a href="#InitializingBean、DisposableBean接口" class="headerlink" title="InitializingBean、DisposableBean接口"></a>InitializingBean、DisposableBean接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">InitializingBean</span>, DisposableBean &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCar</span><span class="params">(Car car)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;自动注入&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.car = car;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;User 构造器&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;@Bean 初始化：initUser&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroyUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;@Bean 销毁：destroyUser&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;destroy&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//见名知意，属性设置后（set赋值完成了）调用</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;afterPropertiesSet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">User 构造器</span><br><span class="line">自动注入</span><br><span class="line">afterPropertiesSet</span><br><span class="line"><span class="meta">@Bean</span> 初始化：initUser</span><br><span class="line">...</span><br><span class="line">======ioc容器创建完成=========</span><br><span class="line">运行：User(name=<span class="literal">null</span>, password=<span class="literal">null</span>, car=com.atguigu.spring.ioc.bean.Car@393881f0)</span><br><span class="line">destroy</span><br><span class="line"><span class="meta">@Bean</span> 销毁：destroyUser</span><br></pre></td></tr></table></figure>

<p>所以 InitializingBean定义的afterPropertiesSet()在自动注入后、初始化组件前调用</p>
<p>DisposableBean定义的destory()在@Bean指定的destory方法前调用</p>
<h3 id="PreDestory、-PostConstruct"><a href="#PreDestory、-PostConstruct" class="headerlink" title="@PreDestory、@PostConstruct"></a>@PreDestory、@PostConstruct</h3><p>@PostConstruct：构造器执行后</p>
<p>@PreDestory：销毁前</p>
<h3 id="后置处理器BeanPostProcessor接口"><a href="#后置处理器BeanPostProcessor接口" class="headerlink" title="后置处理器BeanPostProcessor接口"></a>后置处理器BeanPostProcessor接口</h3><p>使用举例：在初始化后，给User类的组件的属性赋值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyTestBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title class_">BeanPostProcessor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">if</span>(bean <span class="keyword">instanceof</span> User)&#123;</span><br><span class="line">            bean.setUserName(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException &#123;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实@Autowired的实现也是靠后置处理器：</p>
<p>1.专门有一个处理@Autowired注解的AutowiredAnnotationBeanPostProcessor</p>
<p>2.每个Bean创建后，调用BeanPostProcessor的postProcessBeforeInitialization方法</p>
<p>3.postProcessBeforeInitialization会利用反射得到当前Bean的所有属性，利用反射，得到Bean属性上标注的所有注解，看有没有@Autowired注解</p>
<p>4.如果有，去容器中找到这个属性对应的组件（按类型、按名字找到）并装配（或报错）</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><img src="C:\Users\14693\Desktop\Screenshots\屏幕截图 2025-03-06 155252.png" alt="屏幕截图 2025-03-06 155252" style="zoom:150%;" />





<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><p>Aspect Oriented Programming(面向切面编程)</p>
<h2 id="用日志引入"><a href="#用日志引入" class="headerlink" title="用日志引入"></a>用日志引入</h2><h3 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h3><p>静态代理是一种设计模式，它通过创建一个实现相同接口的代理类来控制对实际服务对象的访问。在静态代理中，“静态”意味着代理类是预先定义好的，并且在编译期就已经确定，而不是在运行时动态生成。</p>
<p>静态代理的基本概念</p>
<ul>
<li><strong>目标对象（Real Subject&#x2F;target）</strong>：指的是真正执行业务逻辑的对象。</li>
<li><strong>代理对象（Proxy）</strong>：持有一个对目标对象的引用，并在调用方法之前或之后添加额外的行为（如日志记录、权限验证等），然后再调用目标对象的方法。</li>
</ul>
<p>实现步骤</p>
<ol>
<li><strong>定义接口</strong>：首先需要定义一个接口，该接口声明了所有目标对象和代理对象都将实现的方法。</li>
<li><strong>实现目标对象</strong>：创建一个类实现上述接口，这个类就是我们想要代理的目标对象。</li>
<li><strong>创建代理对象</strong>：创建另一个类同样实现该接口，在这个类中持有目标对象的一个实例，并重写接口中的方法，在这些方法中可以添加额外的功能，然后调用目标对象对应的方法。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MathCalculate</span> &#123;</span><br><span class="line">    <span class="comment">//定义 四则运算</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MathCalculateImpl</span> <span class="keyword">implements</span> <span class="title class_">MathCalculate</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a + b;</span><br><span class="line">        System.out.println(<span class="string">&quot;结果:&quot;</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a - b;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a * b;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a / b;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CalculateStaticProxy</span> <span class="keyword">implements</span> <span class="title class_">MathCalculate</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MathCalculate target;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CalculateStaticProxy</span><span class="params">(MathCalculate target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【日志】 add 开始 参数：&quot;</span>+a+<span class="string">&quot;,&quot;</span>+b);</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> target.add(a, b);</span><br><span class="line">        System.out.println(<span class="string">&quot;【日志】 add 返回 结果：&quot;</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> target.sub(a, b);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> target.mul(a, b);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> target.div(a, b);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MathTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MathCalculate</span> <span class="variable">mathCalculate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MathCalculateImpl</span>();</span><br><span class="line">        <span class="type">CalculateStaticProxy</span> <span class="variable">calculateStaticProxy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CalculateStaticProxy</span>(mathCalculate);</span><br><span class="line">        <span class="type">int</span> result=calculateStaticProxy.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">【日志】 add 开始 参数：1,2</span><br><span class="line">结果:3</span><br><span class="line">【日志】 add 返回 结果：3</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>优点</strong>：<ul>
<li>简单直观，易于理解和实现。</li>
<li>可以在不修改目标对象的前提下增加额外功能。</li>
</ul>
</li>
<li><strong>缺点</strong>：<ul>
<li>每个业务类都需要一个代理类，增加了类的数量，可能导致维护成本上升。</li>
<li>如果接口增加新的方法，则需要同时更新目标类和代理类。</li>
</ul>
</li>
<li><strong>适用场景</strong>：<ul>
<li>当需要在不改变原始代码的情况下给某些方法添加额外功能时。</li>
<li>如日志记录、事务管理、权限验证等横切关注点的处理。</li>
</ul>
</li>
</ul>
<h3 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h3><h4 id="简单实现"><a href="#简单实现" class="headerlink" title="简单实现"></a>简单实现</h4><p>运行期间才决定好代理关系</p>
<p>定义：目标对象在执行期间被动态拦截，插入指定逻辑 (拦截器的思想)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MathCalculate</span> &#123;</span><br><span class="line">    <span class="comment">//定义 四则运算</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MathCalculateImpl</span> <span class="keyword">implements</span> <span class="title class_">MathCalculate</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a + b;</span><br><span class="line">        System.out.println(<span class="string">&quot;结果:&quot;</span>+result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">sub</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a - b;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mul</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a * b;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">div</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> a / b;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MathTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">MathCalculate</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MathCalculateImpl</span>();</span><br><span class="line">        InvocationHandler ih=<span class="keyword">new</span> <span class="title class_">InvocationHandler</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;执行target方法前&quot;</span>);</span><br><span class="line">                Object result=method.invoke(target,args);</span><br><span class="line">                System.out.println(<span class="string">&quot;执行target方法，得到result后&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">MathCalculate</span> <span class="variable">proxy</span> <span class="operator">=</span>(MathCalculate) Proxy.newProxyInstance(</span><br><span class="line">                target.getClass().getClassLoader(),</span><br><span class="line">                target.getClass().getInterfaces(),</span><br><span class="line">                ih</span><br><span class="line">        );</span><br><span class="line">        <span class="type">int</span> result1=proxy.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">        System.out.println(result1);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>使用了匿名内部类的方式创建了一个InvocationHandler接口的实现类的对象ih</p>
<p>用Proxy.newProxyInstance()方法生成代理类的对象（代理类是JVM在运行时动态生成的），强转成MathCalculate类型</p>
<p>用proxy对象调用add方法，实际上将调用转发给了ih，并调用invoke方法（这些我并没有写出来，应该是JVM运行时执行的）</p>
<p>invoke方法使我们可以实现日志的加入</p>
<h4 id="ai说："><a href="#ai说：" class="headerlink" title="ai说："></a>ai说：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">当你调用`Proxy.newProxyInstance()`时，JVM会在运行时为代理对象动态生成一个具体的类（通常是在内存中），这个类实现了你提供的所有接口。每个方法都包含将调用转发给`InvocationHandler`的逻辑</span><br></pre></td></tr></table></figure>

<p>动态代理的核心概念</p>
<ol>
<li><strong>Proxy类</strong>：提供用于创建动态代理类和实例对象的方法。</li>
<li><strong>InvocationHandler接口</strong>：所有动态代理类都需要实现的一个接口，定义了如何处理代理对象的方法调用。</li>
</ol>
<p>工作流程概述</p>
<ul>
<li><strong>步骤1：定义接口和实现类</strong>：首先需要有一个或多个接口以及这些接口的具体实现类。</li>
<li><strong>步骤2：创建InvocationHandler</strong>：实现<code>InvocationHandler</code>接口，定义如何处理方法调用。</li>
<li><strong>步骤3：使用Proxy.newProxyInstance()创建代理对象</strong>：通过提供类加载器、接口数组及自定义的<code>InvocationHandler</code>来创建代理对象。</li>
<li><strong>步骤4：调用代理对象的方法</strong>：当你调用代理对象上的方法时，实际上是在调用由JVM生成的代理类中对应的方法，这些方法会自动将调用转发给关联的<code>InvocationHandler</code>的<code>invoke</code>方法。</li>
</ul>
<p>JVM可能会生成类似如下的代理类（伪代码）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">$Proxy0</span> <span class="keyword">extends</span> <span class="title class_">Proxy</span> <span class="keyword">implements</span> <span class="title class_">Service</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy0(InvocationHandler h) &#123;</span><br><span class="line">        <span class="built_in">super</span>(h);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">performTask</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 将方法调用转发给 InvocationHandler 的 invoke 方法</span></span><br><span class="line">            <span class="built_in">super</span>.h.invoke(<span class="built_in">this</span>, m1, <span class="literal">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Error | RuntimeException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UndeclaredThrowableException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            m1 = Service.class.getMethod(<span class="string">&quot;performTask&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NoSuchMethodError</span>(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>类加载器的作用</p>
<p><code>newProxyInstance</code>方法的第一个参数是一个类加载器，用于加载动态生成的代理类。类加载器负责将生成的代理类加载到JVM中，使其可以被实例化和使用。</p>
<h4 id="改写"><a href="#改写" class="headerlink" title="改写"></a>改写</h4><p>对上面的简单实现进行改写</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获得代理对象的静态方法</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DynamicProxy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">getProxyInstance</span><span class="params">(Object target)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Proxy.newProxyInstance(</span><br><span class="line">                target.getClass().getClassLoader(),</span><br><span class="line">                target.getClass().getInterfaces(),</span><br><span class="line">                (proxy, method, args) -&gt; &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> method.getName();</span><br><span class="line">                    System.out.println(<span class="string">&quot;【日志】：【&quot;</span>+name+<span class="string">&quot;】开始：参数:&quot;</span>+ Arrays.toString(args));</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(target, args);</span><br><span class="line">                    System.out.println(<span class="string">&quot;【日志】：【&quot;</span>+name+<span class="string">&quot;】结束&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> result;</span><br><span class="line">                &#125;</span><br><span class="line">                );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MathTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MathCalculate</span> <span class="variable">proxy</span> <span class="operator">=</span> (MathCalculate) DynamicProxy.getProxyInstance(<span class="keyword">new</span> <span class="title class_">MathCalculateImpl</span>());</span><br><span class="line">        proxy.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>无论哪个类型的对象需要动态代理，都可以调用上面的静态方法获得代理对象</p>
<h2 id="AOP专业术语"><a href="#AOP专业术语" class="headerlink" title="AOP专业术语"></a>AOP专业术语</h2><img src="C:\Users\14693\Desktop\Screenshots\屏幕截图 2025-03-06 225302.png" alt="屏幕截图 2025-03-06 225302" style="zoom: 50%;" />



<h2 id="切面实现示例"><a href="#切面实现示例" class="headerlink" title="切面实现示例"></a>切面实现示例</h2><p>编写切面和通知方法实现AOP</p>
<ul>
<li>导入AOP依赖</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">	&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>编写切面Aspect、编写通知方法、指定切入点表达式</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span><span class="comment">//告诉spring这个组件是个切面</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogAspect</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 告诉spring，以下通知何时何地运行</span></span><br><span class="line"><span class="comment">    *何时？</span></span><br><span class="line"><span class="comment">    * @Before 方法执行前运行</span></span><br><span class="line"><span class="comment">    * @AfterReturning 方法执行正常返回结果运行</span></span><br><span class="line"><span class="comment">    * @AfterThrowing  方法抛出异常运行</span></span><br><span class="line"><span class="comment">    * @After 方法执行之后运行</span></span><br><span class="line"><span class="comment">    *何地？</span></span><br><span class="line"><span class="comment">    *   切入点表达式</span></span><br><span class="line"><span class="comment">    *       execution(方法的全签名)</span></span><br><span class="line"><span class="comment">    *               全签名：</span></span><br><span class="line"><span class="comment">    *               全写法:public int  com.atguigu.spring.aop.calculate.MathCalculate.add(int a,int b) throws ArithmeticException</span></span><br><span class="line"><span class="comment">    *               省略写法:int add(int a,int b)</span></span><br><span class="line"><span class="comment">    *               允许通配符</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logStart</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】开始...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logEnd</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】结束...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logReturn</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】返回...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logException</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】异常...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>测试AOP动态织入</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AopTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    MathCalculate mathCalculate;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//System.out.println(mathCalculate);</span></span><br><span class="line">        mathCalculate.add(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">【切面-日志】开始...</span><br><span class="line">结果:3</span><br><span class="line">【切面-日志】返回...</span><br><span class="line">【切面-日志】结束...</span><br></pre></td></tr></table></figure>

<h3 id="切入点表达式的其他写法"><a href="#切入点表达式的其他写法" class="headerlink" title="切入点表达式的其他写法"></a>切入点表达式的其他写法</h3><ul>
<li>args：参数是指定类型或其子类型的任何连接点</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;args(int,int)&quot;)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>@annotation :判定方法上有没有标注解</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before(&quot;@annotation(注解的全路径)&quot;)</span></span><br></pre></td></tr></table></figure>

<h2 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h2><h3 id="AOP底层原理"><a href="#AOP底层原理" class="headerlink" title="AOP底层原理"></a>AOP底层原理</h3><p>1.Sping会为每个被切面切入的组件创建代理对象（Sping CGLIB创建的，没有接口也可以）</p>
<p>2.代理对象中保存了切面类里所有通知方法构成的增强器链</p>
<p>3.目标方法执行时，会执行增强器链中需要执行的通知方法</p>
<h3 id="JoinPoint连接点信息"><a href="#JoinPoint连接点信息" class="headerlink" title="JoinPoint连接点信息"></a>JoinPoint连接点信息</h3><p>JoinPoint：包装了当前目标方法的所有信息</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Before(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logStart</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        <span class="comment">//拿到方法全签名</span></span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="comment">//方法名</span></span><br><span class="line">        String name=signature.getName();</span><br><span class="line">        <span class="comment">//目标方法传来的参数值</span></span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】 【&quot;</span>+name+<span class="string">&quot;】 开始:参数列表:【&quot;</span>+ Arrays.toString(args)+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logEnd</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> signature.getName();</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】【&quot;</span>+name+<span class="string">&quot;】后置...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning(value=&quot;execution(int *(int,int))&quot;,</span></span><br><span class="line"><span class="meta">            returning=&quot;returnValue&quot;)</span><span class="comment">//returning=&quot;returnValue&quot;获取目标方法返回值</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logReturn</span><span class="params">(JoinPoint joinPoint,Object returnValue)</span>&#123;</span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> signature.getName();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】【&quot;</span>+name+<span class="string">&quot;】返回:&quot;</span>+returnValue);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing(value = &quot;execution(int *(int,int))&quot;,</span></span><br><span class="line"><span class="meta">    throwing=&quot;e&quot;)</span><span class="comment">//获取目标方法抛出的异常</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logException</span><span class="params">(JoinPoint joinPoint,Throwable e)</span>&#123;</span><br><span class="line">        <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> signature.getName();</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-日志】【&quot;</span>+name+<span class="string">&quot;】异常...错误信息:【&quot;</span>+e.getMessage()+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Pointcut抽取切入点表达式"><a href="#Pointcut抽取切入点表达式" class="headerlink" title="@Pointcut抽取切入点表达式"></a>@Pointcut抽取切入点表达式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Pointcut</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Before(&quot;Pointcut()&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logStart</span><span class="params">(JoinPoint joinPoint)</span> &#123;</span><br><span class="line">    <span class="comment">//拿到方法全签名</span></span><br><span class="line">    <span class="type">MethodSignature</span> <span class="variable">signature</span> <span class="operator">=</span> (MethodSignature) joinPoint.getSignature();</span><br><span class="line">    <span class="comment">//方法名</span></span><br><span class="line">    String name=signature.getName();</span><br><span class="line">    <span class="comment">//目标方法传来的参数值</span></span><br><span class="line">    Object[] args = joinPoint.getArgs();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;【切面-日志】 【&quot;</span>+name+<span class="string">&quot;】 开始:参数列表:【&quot;</span>+ Arrays.toString(args)+<span class="string">&quot;】&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="多切面执行顺序"><a href="#多切面执行顺序" class="headerlink" title="多切面执行顺序"></a>多切面执行顺序</h3><p>单切面执行顺序：前置–&gt;目标方法–&gt;返回&#x2F;异常–&gt;后置</p>
<p>我们再添加一个切面：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthAspect</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Pointcut</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After(&quot;Pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-权限】后置&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Before(&quot;Pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-权限】前置&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@AfterReturning(&quot;Pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterReturning</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-权限】返回&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@AfterThrowing(&quot;Pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterThrowing</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;【切面-权限】异常&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多切面执行的顺序是怎样的呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">【切面-权限】前置</span><br><span class="line">【切面-日志】 【add】 开始:参数列表:【[1, 2]】</span><br><span class="line">结果:3</span><br><span class="line">【切面-日志】【add】返回:3</span><br><span class="line">【切面-日志】【add】后置...</span><br><span class="line">【切面-权限】返回</span><br><span class="line">【切面-权限】后置</span><br></pre></td></tr></table></figure>

<p>在这个例子中，其实日志切面是权限切面的目标方法</p>
<p>可以用一个图来表示：</p>
<img src="C:\Users\14693\Desktop\Screenshots\屏幕截图 2025-03-07 092036.png" alt="屏幕截图 2025-03-07 092036" style="zoom: 67%;" />

<p>可以用@order（数字）决定切面优先级顺序 , 数字越小优先级越高。对应的切面也就在上图的越外层</p>
<h3 id="三级缓存"><a href="#三级缓存" class="headerlink" title="三级缓存"></a>三级缓存</h3><p>假设我们有两个单例Bean A和B，它们之间存在循环依赖：</p>
<ul>
<li>当创建Bean A时，发现它依赖于Bean B，因此尝试去创建Bean B。</li>
<li>在创建Bean B的过程中，发现它依赖于Bean A。此时，如果Bean A已经存在于<code>singletonFactories</code>（三级缓存）中，则可以从这里获取Bean A的一个早期引用，将其放入<code>earlySingletonObjects</code>（二级缓存），并返回给Bean B使用。</li>
<li>接着继续完成Bean B的初始化，之后再回到Bean A的创建流程，完成Bean A的初始化。</li>
<li>最终，将完全初始化好的Bean A和Bean B放入<code>singletonObjects</code>（一级缓存）中。</li>
</ul>
<p>关键点总结</p>
<ul>
<li><strong>一级缓存</strong>：存储完全初始化好的Bean实例。</li>
<li><strong>二级缓存</strong>：存储早期暴露的Bean实例，即尚未完成全部初始化步骤的Bean实例。</li>
<li><strong>三级缓存</strong>：存储Bean工厂对象，用于生成早期的Bean实例。</li>
</ul>
<p>详见DefaultSingletonBeanFactory类的getSingleton(String,boolean)方法</p>
<h2 id="环绕通知"><a href="#环绕通知" class="headerlink" title="环绕通知"></a>环绕通知</h2><p>@Around :可以控制目标方法是否执行，修改目标方法参数、执行结果等</p>
<p>环绕通知固定写法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">public Object aroundAdvice(ProceedingJointPoint pjp) throws Throwable&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>举例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AroundAspect</span> &#123;</span><br><span class="line">    <span class="meta">@Pointcut(&quot;execution(int *(int,int))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">Pointcut</span><span class="params">()</span>&#123;&#125;;</span><br><span class="line">    <span class="meta">@Around(&quot;Pointcut()&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">aroundAdvice</span><span class="params">(ProceedingJoinPoint jpj)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//获取目标方法的参数</span></span><br><span class="line">        Object[] args = jpj.getArgs();</span><br><span class="line">        <span class="comment">//前置</span></span><br><span class="line">        System.out.println(<span class="string">&quot;环绕-前置通知 参数：&quot;</span>+ Arrays.toString(args));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">//调用目标方法并返回</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            result= jpj.proceed(args);</span><br><span class="line">            System.out.println(<span class="string">&quot;环绕-返回通知 返回值：&quot;</span>+result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;环绕-异常通知&quot;</span>+e.getMessage());</span><br><span class="line">            <span class="keyword">throw</span> e;<span class="comment">//一定要抛出，不然外一层切面感知不到异常</span></span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;环绕-后置通知&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>日志记录</p>
<ul>
<li><strong>描述</strong>：在系统中的不同层次和位置添加日志记录，以便追踪应用程序的行为。</li>
<li><strong>示例</strong>：在方法调用前后记录输入参数、输出结果以及执行时间。</li>
</ul>
<p>事务管理</p>
<ul>
<li><strong>描述</strong>：确保一组操作要么全部成功，要么全部失败，以保持数据的一致性和完整性。</li>
<li><strong>示例</strong>：在服务层的方法上应用事务控制，自动开始、提交或回滚数据库事务。</li>
</ul>
<p>缓存优化</p>
<ul>
<li><strong>描述</strong>：减少对昂贵资源（如数据库查询）的访问次数，通过缓存结果来加速响应速度。</li>
<li><strong>示例</strong>：为频繁调用但计算成本高的方法添加缓存逻辑，首次调用时存储结果，后续调用直接返回缓存值。</li>
</ul>
<p>异常处理</p>
<ul>
<li><strong>描述</strong>：统一处理异常，避免在每个可能抛出异常的地方编写相同的错误处理代码。</li>
<li><strong>示例</strong>：定义全局异常处理器，在捕获到特定类型的异常时执行预定义的操作，如记录错误日志或向客户端发送错误信息。</li>
</ul>
<p>权限检查等。。。</p>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><h2 id="准备数据源、JdbcTemplate"><a href="#准备数据源、JdbcTemplate" class="headerlink" title="准备数据源、JdbcTemplate"></a>准备数据源、JdbcTemplate</h2><ul>
<li>创建模块时勾选Spring Data JDBC和MySQL Driver</li>
<li>在application.properties中写入</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/spring_tx</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=abc123</span><br></pre></td></tr></table></figure>

<p>就可以对数据库进行操作了</p>
<ul>
<li>还提供了JdbcTemplate方便对数据库进行操作</li>
</ul>
<h2 id="Transactional声名事务"><a href="#Transactional声名事务" class="headerlink" title="@Transactional声名事务"></a>@Transactional声名事务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//开启基于注释的自动化事务管理</span><br><span class="line">@EnableTransactionManagement</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//给方法加上事务</span><br><span class="line">@Transactional</span><br></pre></td></tr></table></figure>

<h3 id="事务管理器参数"><a href="#事务管理器参数" class="headerlink" title="事务管理器参数"></a>事务管理器参数</h3><p>作用：控制事务的获取、提交、回滚</p>
<p>底层默认使用JdbcTransactionManager</p>
<p>原理：</p>
<p>事务管理器配合事务拦截器</p>
<p>1.事务管理器TransactionManager :控制提交和回滚</p>
<p>2.事务拦截器TransacntionInterceptor：控制何时提交和回滚</p>
<pre><code>     2.1completeTransactionAfterThrowing（txInfo，ex）用此方法回滚
</code></pre>
<p>​		 2.2commitTransactionAfterReturning（txInfo）用此方法提交</p>
<h3 id="timeout参数"><a href="#timeout参数" class="headerlink" title="timeout参数"></a>timeout参数</h3><p>设定超时时间，事务超过此事件限制则回滚。</p>
<p>int类型, 以s为单位</p>
<p>**细节:**超时时间是指从方法开始到最后一次数据库操作结束的时间（如果在最后一次dao操作后，使用Thread.sleep(time)使超过时间，不算超时）</p>
<h3 id="rollbackFor参数"><a href="#rollbackFor参数" class="headerlink" title="rollbackFor参数"></a>rollbackFor参数</h3><p><strong>类型：</strong>Class&lt;? extends Throwable&gt;[]</p>
<p><strong>作用</strong>：不是所有异常都一定引起事务回滚，所以我们通过rollbackFor<strong>额外</strong>指明哪些异常需要回滚</p>
<p><strong>异常：</strong></p>
<p>​		运行时异常(unchecked exception【非受检异常】)</p>
<p>​		编译时异常(checked exception【受检异常】)</p>
<p><strong>回滚的默认机制:</strong></p>
<p>​		运行时异常：回滚</p>
<p>​		编译时异常：不回滚</p>
<p><strong>通常指定为</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Transaction(robackFor=&#123;Exception.class&#125;)</span><br></pre></td></tr></table></figure>



<p>同时还有noRollbackFor参数（不说了）</p>
<h3 id="隔离级别参数"><a href="#隔离级别参数" class="headerlink" title="隔离级别参数"></a>隔离级别参数</h3><p>数据库给写的操作加了锁，所以不用担心会发生问题。但是如果一读一写，那么就需要控制读，避免发生问题。</p>
<ul>
<li><strong>READ_UNCOMMITTED</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(isolation = Isolation.READ_UNCOMMITTED)</span></span><br><span class="line"><span class="keyword">public</span> BigDecimal <span class="title function_">getBookPriceById</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from book where id = ?&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate.queryForObject(sql, BigDecimal.class, id);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>给test加上断点，在命令行中开启事务并修改数据</p>
<p>可以读到尚未提交的数据</p>
<p>此外，还有READ_COMMITTED , REPEATABLE_READ , SERIALIZABLE等隔离等级，回看mysql笔记以复习。</p>
<p>mysql默认REPEATABLE_READ</p>
<h3 id="propagation传播行为"><a href="#propagation传播行为" class="headerlink" title="propagation传播行为"></a>propagation传播行为</h3><img src="C:\Users\14693\Desktop\Screenshots\屏幕截图 2025-03-07 162131.png" alt="屏幕截图 2025-03-07 162131" style="zoom:75%;" />

<p>比如在checkout方法（已开启事务）中给扣除金额的方法设置REQUIRED_NEW，给减少库存的方法设置REQUIRED，那么当check事务回滚时，金额不回滚，库存回滚。</p>
<p>注意一定要考虑出现异常的情况，比如上面例子中如果REQUIRE_NEW的方法抛出异常，虽然不在同一个事务，但抛出的异常可能会导致checkout整个大事务回滚。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://mutesniper.github.io">Muite</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://mutesniper.github.io/2025/03/17/spring/">https://mutesniper.github.io/2025/03/17/spring/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JAVA/">JAVA</a><a class="post-meta__tags" href="/tags/note/">note</a><a class="post-meta__tags" href="/tags/Spring/">Spring</a></div><div class="post-share"><div class="social-share" data-image="https://img.alicdn.com/bao/uploaded/i3/2200690044395/O1CN012NL22Q1iKxHYWb17f_!!2200690044395.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/17/springboot/" title="JAVA学习笔记-springBoot"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">JAVA学习笔记-springBoot</div></div><div class="info-2"><div class="info-item-1">简介SpringBoot 帮我们简单、快速地创建一个独立的、生产级别的 Spring 应用； 特性：  快速创建独立 Spring 应用  直接嵌入Tomcat、Jetty or Undertow  提供可选的 starter，简化应用整合  按需自动配置 Spring 以及 第三方库  提供生产级特性：如 监控指标、健康检查、外部化配置等  无代码生成、无xml； 都是基于自动配置技术   场景启动器SpringBoot场景启动器：官方写的启动器命名：spring-boot-starter-*。第三方启动器命名：*-spring-boot-starter ​	作用：场景启动器负责把当前场景需要用的jar包都导入进来 ​	每个场景启动器都有一个基础依赖：spring-boot-starter 依赖管理为什么项目依赖不需要写版本号？—maven父子继承，父项目可以锁定版本。 父项目不管理的包都需要添加版本号 *自动配置基本理解 自动配置 导入场景，容器中就会自动配置好这个场景的核心组件。如 Tomcat、SpringMVC、DataSource...</div></div></div></a><a class="pagination-related" href="/2025/03/17/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" title="JAVA学习笔记-面向对象"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">JAVA学习笔记-面向对象</div></div><div class="info-2"><div class="info-item-1">面向对象封装含义：指的是将数据（变量）和操作数据的方法绑定在一起，并隐藏对象的内部状态，使其对外部不可见或受控访问。通过这种方式，封装提高了代码的安全性、可维护性和灵活性。 目的: 数据隐藏：封装允许隐藏类的内部实现细节，只暴露必要的部分给外部使用。这通常通过将类成员（属性和方法）设置为私有（private），并提供公共（public）的getter和setter方法来访问和修改这些成员。  控制访问级别：通过访问修饰符（public，protected,默认,private）保证只有对应的范围内能够访问和修改某些数据,从而保证了安全性。  增加灵活性：当类的内部实现发生改变时，如果对外接口保持不变，则不需要更改使用该类的所有地方。例如，如果你决定更改某个属性的存储方式或计算方式，只需在对应的getter和setter方法中做出调整即可，而不需要改动所有调用该属性的地方。  增加一些限制：比如在以下代码中的setAge（）方法中对年龄进行筛选   举例：1234567891011121314151617181920212223242526public class Person...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/17/MyBatis/" title="JAVA学习笔记-MyBatis"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">JAVA学习笔记-MyBatis</div></div><div class="info-2"><div class="info-item-1">简介MyBatis是持久层框架（和数据库进行交互的框架） MyBatis 不像 Hibernete 等这些全自动框架，它把关键的SQL部分交给程序员自己编写，而不是自动生成  HelloWorld步骤：  导入mybatis依赖  配置数据源  编写javabean对应数据库一个表模型  以前：Dao接口–&gt;Dao实现  。–&gt;标注@Repository注解 现在：Mapper接口–&gt;Mapper.xml实现 ,–&gt;标注@Mapper注解 （安装mybatisx插件自动为mapper类生成mapper文件，我们只需要在mapper文件中配置方法的sql语句）  告诉mybatis去哪里找mapper文件：mybatis.mapper-locations=classpath:mapper/**.xml   mapper接口： 1234@Mapper //告诉spring，这是MyBatis操作数据库用的接口public interface EmpMapper &#123;    Emp getEmpById(Integer...</div></div></div></a><a class="pagination-related" href="/2025/03/17/springboot/" title="JAVA学习笔记-springBoot"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">JAVA学习笔记-springBoot</div></div><div class="info-2"><div class="info-item-1">简介SpringBoot 帮我们简单、快速地创建一个独立的、生产级别的 Spring 应用； 特性：  快速创建独立 Spring 应用  直接嵌入Tomcat、Jetty or Undertow  提供可选的 starter，简化应用整合  按需自动配置 Spring 以及 第三方库  提供生产级特性：如 监控指标、健康检查、外部化配置等  无代码生成、无xml； 都是基于自动配置技术   场景启动器SpringBoot场景启动器：官方写的启动器命名：spring-boot-starter-*。第三方启动器命名：*-spring-boot-starter ​	作用：场景启动器负责把当前场景需要用的jar包都导入进来 ​	每个场景启动器都有一个基础依赖：spring-boot-starter 依赖管理为什么项目依赖不需要写版本号？—maven父子继承，父项目可以锁定版本。 父项目不管理的包都需要添加版本号 *自动配置基本理解 自动配置 导入场景，容器中就会自动配置好这个场景的核心组件。如 Tomcat、SpringMVC、DataSource...</div></div></div></a><a class="pagination-related" href="/2025/03/17/springMVC/" title="JAVA学习笔记-springMVC"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">JAVA学习笔记-springMVC</div></div><div class="info-2"><div class="info-item-1">简介 SpringMVC是spring的web模块，用来开发Web应用  SpringMVC应用最终作为B&#x2F;S、C&#x2F;S模式下的Server端  Web应用的核心就是处理Http请求响应   两种开发模式 前后不分离开发： 浏览器&#x2F;客户端发送请求，访问指定路径资源–&gt;服务端进行业务处理并用数据组装页面（服务端渲染）–&gt;服务端返回带数据的完整页面给浏览器&#x2F;客户端  前后分离开发： 前端和后端作为独立的部分进行开发，前端专注于用户界面的设计和交互，后端则专注于提供API接口和服务。前端通过AJAX或其他方式调用后端提供的RESTful API获取数据，动态更新页面内容。 前后端分离其实是数据和页面分离，数据由后端负责，页面由前端负责   Helloworld1234567891011@Controller//告诉spring这是一个控制器（处理请求的组件）public class HelloController &#123;    @ResponseBody//把返回值放到响应体中   ...</div></div></div></a><a class="pagination-related" href="/2025/04/03/springCloudAlibaba/" title="JAVA学习笔记-SpringCloudAlibaba"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-03</div><div class="info-item-2">JAVA学习笔记-SpringCloudAlibaba</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/2025/03/17/List/" title="JAVA学习笔记-集合(待更新)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">JAVA学习笔记-集合(待更新)</div></div><div class="info-2"><div class="info-item-1">ArrayList 数组可以存储基本数据类型和引用数据类型，集合只能存储引用数据类型，如果要存储基本数据类型，必须要打包成包装类次啊能存储。  成员方法 添加元素，返回值表示是否添加成功  1boolean add(E e)   删除指定元素,返回值表示是否删除成功  1boolean remove(E e)   删除指定索引的元素,返回被删除的元素  1E remove(int index)   修改指定索引下的元素,返回原来的元素  1E set(int index,E e)   获取指定索引的元素  1E get(int index)   返回集合的长度  1int size()    LinkedList 底层数据结构是双向链表。这使LinkedList的查询慢、增删快。但如果查询的是首尾元素也很快  LinkedList特有的API（用到很少，主要还是collection和list中的方法）  在该列表开头插入指定元素  1public void addFirst(E e)     将指定的元素追加到此列表的末尾  1public void addLast(E...</div></div></div></a><a class="pagination-related" href="/2025/03/17/String/" title="JAVA学习笔记-String"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-17</div><div class="info-item-2">JAVA学习笔记-String</div></div><div class="info-2"><div class="info-item-1">String:特性： 内容不会发生改变，它的对象在创建后不能被更改。如果进行修改则会创建一个新的字符串变量。 由于String对象不可变，所以它是线程安全的。  创建方法： 直接赋值： 1String name=&quot;... &quot;;  构造方法： 1234public String()public String(String original)public String(char[] chs)public String (byte[] chs)  方法： 获取长度：1str.length() 查找子串:1234//返回第一个指定字串的索引str.indexOf...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://img.alicdn.com/bao/uploaded/i3/2200690044395/O1CN012NL22Q1iKxHYWb17f_!!2200690044395.jpg" onerror="this.onerror=null;this.src='/null'" alt="avatar"/></div><div class="author-info-name">Muite</div><div class="author-info-description">keep learning</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mutesniper"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/mutesniper" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8"><span class="toc-number">2.</span> <span class="toc-text">容器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E5%92%8C%E5%AE%B9%E5%99%A8"><span class="toc-number">2.1.</span> <span class="toc-text">组件和容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6"><span class="toc-number">2.1.1.</span> <span class="toc-text">组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8-1"><span class="toc-number">2.1.2.</span> <span class="toc-text">容器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IoC%E5%92%8CDI"><span class="toc-number">2.2.</span> <span class="toc-text">IoC和DI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IoC"><span class="toc-number">2.2.1.</span> <span class="toc-text">IoC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DI"><span class="toc-number">2.2.2.</span> <span class="toc-text">DI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-IoC-%E5%AE%B9%E5%99%A8%E7%AE%A1%E7%90%86%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">2.2.3.</span> <span class="toc-text">Spring IoC 容器管理的内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C"><span class="toc-number">2.3.</span> <span class="toc-text">注册</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%8A%E7%BB%84%E4%BB%B6%E6%94%BE%E8%BF%9B%E5%AE%B9%E5%99%A8%E4%B8%AD"><span class="toc-number">2.3.1.</span> <span class="toc-text">把组件放进容器中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%BB%84%E4%BB%B6"><span class="toc-number">2.3.2.</span> <span class="toc-text">获取组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E7%9A%84%E5%88%9B%E5%BB%BA%E6%97%B6%E6%9C%BA"><span class="toc-number">2.3.3.</span> <span class="toc-text">组件的创建时机:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">2.3.4.</span> <span class="toc-text">配置类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MVC%E5%88%86%E5%B1%82%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.3.5.</span> <span class="toc-text">MVC分层注解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E6%89%AB%E6%8F%8F"><span class="toc-number">2.3.6.</span> <span class="toc-text">批量扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BB%84%E4%BB%B6"><span class="toc-number">2.3.7.</span> <span class="toc-text">导入第三方组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E6%95%B4%E7%BB%84%E4%BB%B6%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">2.3.8.</span> <span class="toc-text">调整组件作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.3.9.</span> <span class="toc-text">单例情况下的懒加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E5%B7%A5%E5%8E%82%E5%88%B6%E9%80%A0%E5%A4%8D%E6%9D%82Bean"><span class="toc-number">2.3.10.</span> <span class="toc-text">利用工厂制造复杂Bean</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Conditional"><span class="toc-number">2.3.11.</span> <span class="toc-text">@Conditional</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B3%A8%E5%86%8C"><span class="toc-number">2.3.11.1.</span> <span class="toc-text">条件注册</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Conditional%E6%B4%BE%E7%94%9F%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.3.11.2.</span> <span class="toc-text">@Conditional派生注解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5"><span class="toc-number">2.4.</span> <span class="toc-text">注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Autowired%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D"><span class="toc-number">2.4.1.</span> <span class="toc-text">@Autowired自动装配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Qualifier%E5%92%8C-Primary"><span class="toc-number">2.4.2.</span> <span class="toc-text">@Qualifier和@Primary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource%E8%87%AA%E5%8A%A8%E6%B3%A8%E5%85%A5"><span class="toc-number">2.4.3.</span> <span class="toc-text">@Resource自动注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%99%A8%E6%B3%A8%E5%85%A5"><span class="toc-number">2.4.4.</span> <span class="toc-text">构造器注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setter%E6%96%B9%E6%B3%95%E6%B3%A8%E5%85%A5"><span class="toc-number">2.4.5.</span> <span class="toc-text">setter方法注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xxxAware%E6%84%9F%E7%9F%A5%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.4.6.</span> <span class="toc-text">xxxAware感知接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#value-%E5%B1%9E%E6%80%A7%E8%B5%8B%E5%80%BC"><span class="toc-number">2.4.7.</span> <span class="toc-text">@value 属性赋值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PropertySource"><span class="toc-number">2.4.8.</span> <span class="toc-text">@ PropertySource</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ResourceUtils%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90"><span class="toc-number">2.4.9.</span> <span class="toc-text">ResourceUtils获取资源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Profile-%E5%A4%9A%E7%8E%AF%E5%A2%83"><span class="toc-number">2.4.10.</span> <span class="toc-text">@Profile 多环境</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.5.</span> <span class="toc-text">生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Bean%E6%8C%87%E5%AE%9A%E5%88%9D%E5%A7%8B%E5%8C%96%E3%80%81%E9%94%80%E6%AF%81%E6%96%B9%E6%B3%95"><span class="toc-number">2.5.1.</span> <span class="toc-text">@Bean指定初始化、销毁方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InitializingBean%E3%80%81DisposableBean%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.5.2.</span> <span class="toc-text">InitializingBean、DisposableBean接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PreDestory%E3%80%81-PostConstruct"><span class="toc-number">2.5.3.</span> <span class="toc-text">@PreDestory、@PostConstruct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%BD%AE%E5%A4%84%E7%90%86%E5%99%A8BeanPostProcessor%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.5.4.</span> <span class="toc-text">后置处理器BeanPostProcessor接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">2.5.5.</span> <span class="toc-text">小结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AOP"><span class="toc-number">3.</span> <span class="toc-text">AOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8%E6%97%A5%E5%BF%97%E5%BC%95%E5%85%A5"><span class="toc-number">3.1.</span> <span class="toc-text">用日志引入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">3.1.1.</span> <span class="toc-text">静态代理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86"><span class="toc-number">3.1.2.</span> <span class="toc-text">动态代理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.1.2.1.</span> <span class="toc-text">简单实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ai%E8%AF%B4%EF%BC%9A"><span class="toc-number">3.1.2.2.</span> <span class="toc-text">ai说：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%B9%E5%86%99"><span class="toc-number">3.1.2.3.</span> <span class="toc-text">改写</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AOP%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD"><span class="toc-number">3.2.</span> <span class="toc-text">AOP专业术语</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%87%E9%9D%A2%E5%AE%9E%E7%8E%B0%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.3.</span> <span class="toc-text">切面实现示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%85%B6%E4%BB%96%E5%86%99%E6%B3%95"><span class="toc-number">3.3.1.</span> <span class="toc-text">切入点表达式的其他写法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%86%E8%8A%82"><span class="toc-number">3.4.</span> <span class="toc-text">细节</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AOP%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="toc-number">3.4.1.</span> <span class="toc-text">AOP底层原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JoinPoint%E8%BF%9E%E6%8E%A5%E7%82%B9%E4%BF%A1%E6%81%AF"><span class="toc-number">3.4.2.</span> <span class="toc-text">JoinPoint连接点信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pointcut%E6%8A%BD%E5%8F%96%E5%88%87%E5%85%A5%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.4.3.</span> <span class="toc-text">@Pointcut抽取切入点表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%88%87%E9%9D%A2%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">3.4.4.</span> <span class="toc-text">多切面执行顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="toc-number">3.4.5.</span> <span class="toc-text">三级缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E7%BB%95%E9%80%9A%E7%9F%A5"><span class="toc-number">3.5.</span> <span class="toc-text">环绕通知</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">3.6.</span> <span class="toc-text">应用场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.</span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E6%95%B0%E6%8D%AE%E6%BA%90%E3%80%81JdbcTemplate"><span class="toc-number">4.1.</span> <span class="toc-text">准备数据源、JdbcTemplate</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Transactional%E5%A3%B0%E5%90%8D%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.2.</span> <span class="toc-text">@Transactional声名事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.1.</span> <span class="toc-text">事务管理器参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#timeout%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.2.</span> <span class="toc-text">timeout参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rollbackFor%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.3.</span> <span class="toc-text">rollbackFor参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%8F%82%E6%95%B0"><span class="toc-number">4.2.4.</span> <span class="toc-text">隔离级别参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#propagation%E4%BC%A0%E6%92%AD%E8%A1%8C%E4%B8%BA"><span class="toc-number">4.2.5.</span> <span class="toc-text">propagation传播行为</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/10/Kafka/" title="JAVA学习笔记-Kafka">JAVA学习笔记-Kafka</a><time datetime="2025-04-10T04:46:00.000Z" title="Created 2025-04-10 12:46:00">2025-04-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/06/MyBatisPlus/" title="JAVA学习笔记-MyBatisPlus">JAVA学习笔记-MyBatisPlus</a><time datetime="2025-04-06T04:46:00.000Z" title="Created 2025-04-06 12:46:00">2025-04-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/05/Docker/" title="Ubuntu下Docker基本使用">Ubuntu下Docker基本使用</a><time datetime="2025-04-05T04:46:00.000Z" title="Created 2025-04-05 12:46:00">2025-04-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/04/docker%E8%BF%90%E8%A1%8C%E6%8A%A5%E9%94%99/" title="安装Docker后运行helloworld报错解决方案">安装Docker后运行helloworld报错解决方案</a><time datetime="2025-04-04T04:46:00.000Z" title="Created 2025-04-04 12:46:00">2025-04-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/03/springCloudAlibaba/" title="JAVA学习笔记-SpringCloudAlibaba">JAVA学习笔记-SpringCloudAlibaba</a><time datetime="2025-04-03T04:46:00.000Z" title="Created 2025-04-03 12:46:00">2025-04-03</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By Muite</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v6.2.0" title=""><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题版本Butterfly_v4.3.1" title=""><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title=""><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><script async src="/js/runtime.js"></script><!-- hexo injector body_end end --></body></html>